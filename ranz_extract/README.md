# RANZ Roofing Guide Data Extraction

Data extracted from https://www.roofguide.co.nz/ on 2026-01-30.

## Files

| File | Description | Status |
|------|-------------|--------|
| `ranz_schema.json` | Menu structure and guide hierarchy | ✓ Complete |
| `model_mapping.json` | GLB filename → detail code mapping | ✓ Complete |
| `ranz_stories.json` | Complete stage/step data for all 62 guides | ✓ Complete (985 KB) |
| `stage_metadata.json` | Processed 3D sync data (generated by import) | Generated on import |

## Import Command

```bash
npm run db:import-ranz
```

This will:
1. Parse all 62 RANZ guides from `ranz_stories.json`
2. Create/update detail records with `sourceId: 'ranz-guide'`
3. Create step records with installation instructions
4. Link to GLB models in `/public/models/`
5. Generate `stage_metadata.json` for 3D synchronization

## Code Prefixing

RANZ codes are prefixed with `RANZ-` to avoid conflicts with MRM codes:
- MRM: `F01`, `F02`, ... (flashings from MRM COP)
- RANZ: `RANZ-F01`, `RANZ-F02`, ... (flashings from RANZ Guide)

This allows both sources to coexist in the unified COP.

## Data Structure

### Stories Format

Each guide in `ranz_stories.json` contains:

```json
{
  "grf101": [{
    "c": "Drip Edge Flashing under 10°",  // Title
    "r": "F01",                            // Code
    "s": [                                 // Stages array
      {
        "l": [...],                        // Labels (instructions)
        "a": [...],                        // Actions (layer visibility)
        "v": {...},                        // Viewport (camera position)
        "t": "...",                        // Stage title
        "p": "..."                         // Procedure notes (HTML)
      }
    ]
  }]
}
```

### Label Format

Each label (instruction marker) contains:

```json
{
  "c": "Spouting",           // Content text
  "p": [x, y, z],            // 3D position
  "n": [x, y, z],            // Normal vector
  "m": "a",                  // Marker letter
  "f": true                  // Featured (highlighted)
}
```

### Camera Format

```json
{
  "l": [x, y, z],            // Camera location
  "c": [x, y, z],            // Camera target (look-at)
  "a": false                 // Auto-focus flag
}
```

## 3D Models

Models are stored in `/public/models/` with filenames matching the guide keys:
- `grf101.glb` → F01 Drip Edge Flashing
- `gpc102.glb` → C02 Round Overflashing
- etc.

## Import Process

1. Save `ranz_stories.json` from browser (see extraction instructions)
2. Run `npm run import:ranz` to transform and import to database
3. Verify in admin panel

## Source

- Site: RANZ Roofing Guide (roofguide.co.nz)
- Data version: stories.js?ver=1.02
- Extraction date: 2026-01-30
