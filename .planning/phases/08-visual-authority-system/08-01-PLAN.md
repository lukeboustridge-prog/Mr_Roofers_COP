---
phase: 08-visual-authority-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/authority/AuthoritativeContent.tsx
  - components/authority/SupplementaryContent.tsx
  - components/authority/VersionWatermark.tsx
  - components/authority/ContentCapabilityBadges.tsx
  - components/authority/index.ts
  - lib/constants.ts
autonomous: true

must_haves:
  truths:
    - "AuthoritativeContent wrapper applies blue border-left and blue-tinted background"
    - "SupplementaryContent wrapper applies grey border-left and grey-tinted background"
    - "VersionWatermark displays 'MRM COP v25.12' in subtle typography"
    - "ContentCapabilityBadges shows icons for 3D model, steps, warnings, case law"
    - "getAuthorityLevel returns 'authoritative' for mrm-cop, 'supplementary' for others"
  artifacts:
    - path: "components/authority/AuthoritativeContent.tsx"
      provides: "Blue-styled wrapper for MRM COP content"
      exports: ["AuthoritativeContent"]
    - path: "components/authority/SupplementaryContent.tsx"
      provides: "Grey-styled wrapper for RANZ content"
      exports: ["SupplementaryContent"]
    - path: "components/authority/VersionWatermark.tsx"
      provides: "COP version watermark display"
      exports: ["VersionWatermark"]
    - path: "components/authority/ContentCapabilityBadges.tsx"
      provides: "Icon badges for content capabilities"
      exports: ["ContentCapabilityBadges"]
    - path: "components/authority/index.ts"
      provides: "Barrel export for all authority components"
    - path: "lib/constants.ts"
      provides: "getAuthorityLevel helper function"
      contains: "getAuthorityLevel"
  key_links:
    - from: "components/authority/AuthoritativeContent.tsx"
      to: "components/authority/VersionWatermark.tsx"
      via: "optional showWatermark prop renders VersionWatermark"
      pattern: "showWatermark.*VersionWatermark"
    - from: "lib/constants.ts"
      to: "CONTENT_SOURCES"
      via: "getAuthorityLevel checks sourceId against mrm-cop"
      pattern: "mrm-cop.*authoritative"
---

<objective>
Create foundation components for the Visual Authority System: wrapper components for authoritative and supplementary content styling, version watermark, capability badges, and authority detection helper.

Purpose: These components enable visual distinction between MRM COP (authoritative) and RANZ Guide (supplementary) content across the application, establishing consistent styling patterns.

Output: New components/authority/ directory with AuthoritativeContent, SupplementaryContent, VersionWatermark, ContentCapabilityBadges, and updated lib/constants.ts with getAuthorityLevel helper.
</objective>

<execution_context>
@C:\Users\LukeBoustridge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\LukeBoustridge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-visual-authority-system/08-RESEARCH.md

# Existing patterns to follow
@lib/utils.ts
@lib/constants.ts
@components/ui/badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create authority wrapper components and version watermark</name>
  <files>
    components/authority/AuthoritativeContent.tsx
    components/authority/SupplementaryContent.tsx
    components/authority/VersionWatermark.tsx
  </files>
  <action>
Create three new files in components/authority/:

1. **VersionWatermark.tsx:**
   - Simple span component displaying "MRM COP {version}"
   - Default version prop = 'v25.12'
   - Styling: text-[10px] text-primary/40 font-mono tracking-tight select-none
   - Add aria-hidden="true" (decorative element)
   - Use cn() for className merging

2. **AuthoritativeContent.tsx:**
   - Wrapper component accepting children and optional showWatermark boolean
   - Styling: relative rounded-lg border-l-4 border-primary bg-primary/5 p-4
   - When showWatermark=true, render VersionWatermark positioned absolute top-2 right-2
   - Import VersionWatermark and cn from lib/utils

3. **SupplementaryContent.tsx:**
   - Wrapper component accepting children
   - Styling: relative rounded-lg border-l-4 border-slate-300 bg-slate-50 p-4
   - No watermark (supplementary content doesn't need version attribution)
   - Use cn() for className merging

All components should be client components ('use client') since they may be used in interactive contexts, and accept className prop for extensibility.
  </action>
  <verify>
    Files exist at expected paths:
    - components/authority/VersionWatermark.tsx exports VersionWatermark
    - components/authority/AuthoritativeContent.tsx exports AuthoritativeContent
    - components/authority/SupplementaryContent.tsx exports SupplementaryContent

    Run: npm run build (should compile without TypeScript errors)
  </verify>
  <done>
    Three wrapper components exist with correct Tailwind styling for visual authority distinction. AuthoritativeContent renders blue border-left and optional watermark. SupplementaryContent renders grey border-left.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ContentCapabilityBadges component</name>
  <files>
    components/authority/ContentCapabilityBadges.tsx
  </files>
  <action>
Create ContentCapabilityBadges.tsx:

1. Import icons from lucide-react:
   - Box (for 3D model)
   - ListChecks (for installation steps)
   - AlertTriangle (for warnings)
   - Scale (for case law)

2. Import Tooltip components from @/components/ui/tooltip

3. Define ContentCapabilities interface:
   ```typescript
   interface ContentCapabilities {
     has3DModel: boolean;
     hasSteps: boolean;
     hasWarnings: boolean;
     hasCaseLaw: boolean;
   }
   ```

4. Create component with props: capabilities: ContentCapabilities, className?: string

5. Render flex container (gap-1) with only icons for TRUE capabilities:
   - has3DModel: Box with text-blue-500, Tooltip "Has 3D Model"
   - hasSteps: ListChecks with text-green-500, Tooltip "Has Installation Steps"
   - hasWarnings: AlertTriangle with text-amber-500, Tooltip "Has Warnings"
   - hasCaseLaw: Scale with text-red-500, Tooltip "Related Case Law"

6. All icons should be h-4 w-4 (16px)

7. Order badges: 3D, Steps, Warnings, CaseLaw (constructive to cautionary)

8. Wrap with TooltipProvider at component level

Note: Only render icons for capabilities that are TRUE - do not show greyed-out placeholders (per research pitfall #3).
  </action>
  <verify>
    File exists at components/authority/ContentCapabilityBadges.tsx
    Exports ContentCapabilityBadges component
    Run: npm run build (should compile without TypeScript errors)
  </verify>
  <done>
    ContentCapabilityBadges component renders colored icons with tooltips for each available capability, showing only icons where capability is true.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add getAuthorityLevel helper and create barrel export</name>
  <files>
    lib/constants.ts
    components/authority/index.ts
  </files>
  <action>
1. **Update lib/constants.ts:**
   Add at the end of the file:
   ```typescript
   // Authority levels for visual distinction
   export type AuthorityLevel = 'authoritative' | 'supplementary';

   /**
    * Determines authority level based on content source ID.
    * MRM COP is authoritative (primary source for Building Code citation).
    * All other sources are supplementary.
    */
   export function getAuthorityLevel(sourceId: string | null | undefined): AuthorityLevel {
     return sourceId === 'mrm-cop' ? 'authoritative' : 'supplementary';
   }
   ```

2. **Create components/authority/index.ts:**
   Barrel export all components:
   ```typescript
   export { AuthoritativeContent } from './AuthoritativeContent';
   export { SupplementaryContent } from './SupplementaryContent';
   export { VersionWatermark } from './VersionWatermark';
   export { ContentCapabilityBadges } from './ContentCapabilityBadges';
   export type { ContentCapabilities } from './ContentCapabilityBadges';
   ```

This enables clean imports like:
`import { AuthoritativeContent, ContentCapabilityBadges } from '@/components/authority';`
  </action>
  <verify>
    - lib/constants.ts contains getAuthorityLevel function
    - getAuthorityLevel('mrm-cop') returns 'authoritative'
    - getAuthorityLevel('ranz-guide') returns 'supplementary'
    - getAuthorityLevel(null) returns 'supplementary'
    - components/authority/index.ts exports all 4 components

    Run: npm run build (should compile without TypeScript errors)
  </verify>
  <done>
    getAuthorityLevel helper function exists in lib/constants.ts. Barrel export in components/authority/index.ts exports all authority components.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run build` - should complete without TypeScript errors
2. Check that all files exist in components/authority/
3. Verify getAuthorityLevel function works correctly:
   - 'mrm-cop' -> 'authoritative'
   - 'ranz-guide' -> 'supplementary'
   - null/undefined -> 'supplementary'
4. Verify barrel export works: import paths resolve correctly
</verification>

<success_criteria>
- [ ] components/authority/ directory contains 5 files (4 components + index.ts)
- [ ] AuthoritativeContent renders with blue border-left styling
- [ ] SupplementaryContent renders with grey border-left styling
- [ ] VersionWatermark displays "MRM COP v25.12" in subtle styling
- [ ] ContentCapabilityBadges renders correct icons with tooltips
- [ ] getAuthorityLevel correctly identifies MRM COP as authoritative
- [ ] npm run build completes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-visual-authority-system/08-01-SUMMARY.md`
</output>
