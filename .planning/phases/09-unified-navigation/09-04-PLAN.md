---
phase: 09-unified-navigation
plan: 04
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - app/(dashboard)/page.tsx
  - lib/db/queries/topics.ts
autonomous: false

must_haves:
  truths:
    - "User can access Topics navigation from the home page"
    - "User can see topic cards on home page with detail counts"
    - "Home page provides clear path to unified topic-based navigation"
  artifacts:
    - path: "app/(dashboard)/page.tsx"
      provides: "Home page with Topics section"
      contains: "Topics"
  key_links:
    - from: "app/(dashboard)/page.tsx"
      to: "lib/db/queries/topics"
      via: "getTopicsWithCounts query"
      pattern: "getTopicsWithCounts"
---

<objective>
Add Topics navigation to home page and verify full navigation flow.

Purpose: Ensure users can discover and access the unified topic-based navigation from the main entry point. This completes the navigation integration and enables visual verification of the full flow.

Output: Home page updated with Topics section, full navigation flow verified.
</objective>

<execution_context>
@C:\Users\LukeBoustridge\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\LukeBoustridge\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Topic pages from Plan 01
@app/(dashboard)/topics/page.tsx
@app/(dashboard)/topics/[topicId]/page.tsx

# Query function
@lib/db/queries/topics.ts

# Existing home page to enhance
@app/(dashboard)/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Topics Section to Home Page</name>
  <files>app/(dashboard)/page.tsx</files>
  <action>
Update the home page to include a Topics section for quick access to unified navigation.

1. Import getTopicsWithCounts from @/lib/db/queries/topics
2. Fetch topics with counts in the server component
3. Add a new section after existing sections (e.g., after Quick Access or Recent):

```tsx
<section className="mt-8">
  <div className="flex items-center justify-between mb-4">
    <h2 className="text-xl font-semibold text-slate-900">Browse by Topic</h2>
    <Link href="/topics" className="text-sm text-primary hover:underline">
      View all topics
    </Link>
  </div>
  <div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
    {topics.slice(0, 6).map((topic) => (
      <Link key={topic.id} href={`/topics/${topic.id}`}>
        <Card className="h-full cursor-pointer transition-all hover:shadow-md hover:border-primary/50">
          <CardContent className="p-4">
            <h3 className="font-medium text-slate-900">{topic.name}</h3>
            {topic.description && (
              <p className="mt-1 text-sm text-slate-500 line-clamp-2">{topic.description}</p>
            )}
            <div className="mt-2 flex items-center gap-2">
              <Badge variant="secondary">{topic.detailCount} details</Badge>
              <span className="text-xs text-slate-400">
                across {topic.categoryCount} categories
              </span>
            </div>
          </CardContent>
        </Card>
      </Link>
    ))}
  </div>
</section>
```

4. Show top 6 topics (most relevant based on sort order from database)
5. Include "View all topics" link to /topics
6. If no topics exist, don't show the section (graceful degradation)

Keep existing sections (Quick Access, Recent, Favourites) intact.
  </action>
  <verify>
Run `npm run build` - no errors.
Navigate to http://localhost:3000/ - Topics section visible.
Topic cards link to /topics/{topicId}.
"View all topics" links to /topics.
  </verify>
  <done>
Home page includes Browse by Topic section with topic cards and counts.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify Complete Navigation Flow</name>
  <what-built>
Complete unified navigation system including:
- Topics listing page (/topics)
- Topic detail pages with source tabs and capability filters
- Filter state persisting in URL
- Home page Topics section
- Breadcrumb navigation throughout
  </what-built>
  <how-to-verify>
1. Navigate to http://localhost:3000/
2. Verify "Browse by Topic" section shows topic cards with counts
3. Click a topic card (e.g., "Flashings")
4. Verify you reach /topics/flashings with details listed
5. Verify source tabs show (All / MRM COP / RANZ Guide) with counts
6. Click "MRM COP" tab - URL should update to ?source=mrm-cop
7. Verify list filters to only MRM content
8. Check a capability filter (e.g., "Has 3D Model")
9. Verify URL updates to include ?capabilities=3d
10. Verify list filters correctly
11. Use browser back button - verify filter state restores
12. Copy the URL and open in new tab - verify filters persist
13. Check breadcrumbs show: Home > Topics > [Topic Name]
14. Navigate to an empty topic (if any exist) - verify Coming Soon placeholder
  </how-to-verify>
  <resume-signal>Type "approved" if navigation works correctly, or describe issues found.</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with no errors
2. Home page shows Browse by Topic section
3. Complete navigation flow works:
   - Home -> Topics -> Topic Detail -> Filtered View
4. URL state persists correctly
5. Breadcrumbs work throughout
6. Empty states handled gracefully
</verification>

<success_criteria>
- User can discover Topics from home page
- Complete navigation flow works end-to-end
- Filter state persists in URL
- Visual verification confirms all requirements met
</success_criteria>

<output>
After completion, create `.planning/phases/09-unified-navigation/09-04-SUMMARY.md`
</output>
